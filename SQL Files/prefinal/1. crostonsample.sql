SET SCHEMA PALTEST;
DROP TYPE PAL_CROSTON_DATA_T;
CREATE TYPE PAL_CROSTON_DATA_T AS TABLE("ID" INT, "RAWDATA" DOUBLE);
DROP TYPE PAL_CONTROL_T;
CREATE TYPE PAL_CONTROL_T AS TABLE("NAME" VARCHAR(100), "INTARGS" INT,
"DOUBLEARGS" DOUBLE, "STRINGARGS" VARCHAR(100));
DROP TYPE PAL_CROSTON_RESULT_T;
CREATE TYPE PAL_CROSTON_RESULT_T AS TABLE("TIME" INT, "OUTPUT" DOUBLE);
DROP TYPE PAL_CROSTON_STATISTICS_T;
CREATE TYPE PAL_CROSTON_STATISTICS_T AS TABLE ("NAME" VARCHAR (50), "VALUE"
DOUBLE);
DROP TABLE PAL_CROSTON_PDATA_TBL;
CREATE COLUMN TABLE PAL_CROSTON_PDATA_TBL ("POSITION" INT,"SCHEMA_NAME"
NVARCHAR(256),"TYPE_NAME" NVARCHAR (256),"PARAMETER_TYPE" VARCHAR (7));
INSERT INTO PAL_CROSTON_PDATA_TBL VALUES (1,'PALTEST','PAL_CROSTON_DATA_T','IN');
INSERT INTO PAL_CROSTON_PDATA_TBL VALUES (2,'PALTEST','PAL_CONTROL_T','IN');
INSERT INTO PAL_CROSTON_PDATA_TBL VALUES
(3,'PALTEST','PAL_CROSTON_RESULT_T','OUT');
INSERT INTO PAL_CROSTON_PDATA_TBL VALUES
(4,'PALTEST','PAL_CROSTON_STATISTICS_T','OUT');
CALL SYS.AFLLANG_WRAPPER_PROCEDURE_DROP('PALTEST','CROSTON_TEST_PROC');
CALL SYS.AFLLANG_WRAPPER_PROCEDURE_CREATE('AFLPAL','CROSTON', 'PALTEST',
'CROSTON_TEST_PROC', PAL_CROSTON_PDATA_TBL);
DROP TABLE #PAL_CONTROL_TBL;
CREATE LOCAL TEMPORARY COLUMN TABLE #PAL_CONTROL_TBL ("NAME" VARCHAR(100),
"INTARGS" INT, "DOUBLEARGS" DOUBLE, "STRINGARGS" VARCHAR(100));
INSERT INTO #PAL_CONTROL_TBL VALUES ('RAW_DATA_COL',1,NULL,NULL);
INSERT INTO #PAL_CONTROL_TBL VALUES ('ALPHA', NULL,0.1,NULL);
INSERT INTO #PAL_CONTROL_TBL VALUES ('FORECAST_NUM',6, NULL,NULL);
INSERT INTO #PAL_CONTROL_TBL VALUES ('METHOD',0, NULL,NULL);
INSERT INTO #PAL_CONTROL_TBL VALUES('MEASURE_NAME',NULL,NULL,'MAPE');
DROP TABLE PAL_CROSTON_DATA_TBL;
CREATE COLUMN TABLE PAL_CROSTON_DATA_TBL LIKE PAL_CROSTON_DATA_T ;
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(1, 57312.88);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(2, 77039.16);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(3, 71343.67);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(4, 68489.11);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(5, 53801.93);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(6, 79195.03);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(7, 243981.66);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(8, 2577.32);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(9, 75956.42);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(10, 64164.82);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(11, 84081.22);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(12, 24412.22);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(13, 154528.97);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(14, 84783.76);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(15, 101978.24);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(16, 51590.35);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(17, 79878.24);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(18, 116343.56);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(19, 122209.01);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(20, 3028.45);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(21, 274990.78);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(22, 11012.2);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(23, 71462.24);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(24, 63634.56);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(25, 60547.55);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(26, 74553.63);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(27, 69781.7);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(28, 72287.79);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(29, 57409.73);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(30, 73188.88);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(31, 81387.3);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(32, 4625.65);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(33, 106285.13);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(34, 61743.06);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(35, 296981.07);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(36, 140746.17);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(37, 71113.66);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(38, 81149.87);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(39, 151185.03);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(40, 13490.76);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(41, 73574.28);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(42, 7457.74);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(43, 71250.98);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(44, 208251.84);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(45, 12804.33);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(46, 69400.76);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(47, 65274.19);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(48, 71857.16);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(49, 235056.39);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(50, 163227.25);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(51, 9650.08);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(52, 129895.45);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(53, 12040.52);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(54, 100209.58);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(55, 88291.87);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(56, 69938.26);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(57, 103210.2);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(58, 66333.84);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(59, 10553.58);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(60, 138126.56);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(61, 83546.0);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(62, 249540.18);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(63, 123265.03);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(64, 94891.8);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(65, 58415.47);
INSERT INTO PAL_CROSTON_DATA_TBL VALUES(66, 63160.2);
DROP TABLE PAL_CROSTON_RESULT_TBL;
CREATE COLUMN TABLE PAL_CROSTON_RESULT_TBL LIKE PAL_CROSTON_RESULT_T;
DROP TABLE PAL_CROSTON_STATISTICS_TBL;
CREATE COLUMN TABLE PAL_CROSTON_STATISTICS_TBL LIKE PAL_CROSTON_STATISTICS_T;
CALL PALTEST.CROSTON_TEST_PROC(PAL_CROSTON_DATA_TBL, "#PAL_CONTROL_TBL",
PAL_CROSTON_RESULT_TBL, PAL_CROSTON_STATISTICS_TBL) WITH OVERVIEW;
SELECT * FROM PAL_CROSTON_RESULT_TBL;

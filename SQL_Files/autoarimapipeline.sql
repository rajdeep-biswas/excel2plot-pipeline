SET SCHEMA PALTEST;
DROP TABLE PAL_ARIMA_PDATA_TBL;
CREATE COLUMN TABLE PAL_ARIMA_PDATA_TBL("POSITION" INT, "SCHEMA_NAME" NVARCHAR(256), "TYPE_NAME" NVARCHAR(256), "PARAMETER_TYPE" VARCHAR(7));
INSERT INTO PAL_ARIMA_PDATA_TBL VALUES (1, 'PALTEST', 'PAL_ARIMA_DATA_T', 'IN');
INSERT INTO PAL_ARIMA_PDATA_TBL VALUES (2, 'PALTEST', 'PAL_ARIMA_CONTROL_T', 'IN');
INSERT INTO PAL_ARIMA_PDATA_TBL VALUES (3, 'PALTEST', 'PAL_ARIMA_MODEL_T', 'OUT');
CALL SYS.AFLLANG_WRAPPER_PROCEDURE_DROP('PALTEST', 'PAL_AUTOARIMA_PROC');
CALL SYS.AFLLANG_WRAPPER_PROCEDURE_CREATE('AFLPAL','AUTOARIMA', 'PALTEST', 'PAL_AUTOARIMA_PROC', PAL_ARIMA_PDATA_TBL);
DROP TABLE PAL_ARIMA_DATA_TBL;
CREATE COLUMN TABLE PAL_ARIMA_DATA_TBL LIKE PAL_ARIMA_DATA_T;
INSERT_QUERIES_GO_HERE DROP TABLE PAL_CONTROL_TBL;
CREATE COLUMN TABLE PAL_CONTROL_TBL ( "NAME" VARCHAR (50),"INTARGS" INTEGER,"DOUBLEARGS" DOUBLE,"STRINGARGS" VARCHAR (100));
INSERT INTO PAL_CONTROL_TBL VALUES ('SEARCH_STRATEGY', 1,null,null);
DROP TABLE PAL_ARIMA_MODEL_TBL;
CREATE COLUMN TABLE PAL_ARIMA_MODEL_TBL LIKE PAL_ARIMA_MODEL_T;
CALL PALTEST.PAL_AUTOARIMA_PROC(PAL_ARIMA_DATA_TBL, "PAL_CONTROL_TBL", PAL_ARIMA_MODEL_TBL) WITH OVERVIEW;
DROP TABLE PAL_ARIMA_PDATA_TBL;
CREATE COLUMN TABLE PAL_ARIMA_PDATA_TBL("POSITION" INT, "SCHEMA_NAME" NVARCHAR(256), "TYPE_NAME" NVARCHAR(256), "PARAMETER_TYPE" VARCHAR(7));
INSERT INTO PAL_ARIMA_PDATA_TBL VALUES (1, 'PALTEST', 'PAL_ARIMA_MODEL_T', 'IN');
INSERT INTO PAL_ARIMA_PDATA_TBL VALUES (2, 'PALTEST', 'PAL_ARIMA_CONTROL_T', 'IN');
INSERT INTO PAL_ARIMA_PDATA_TBL VALUES (3, 'PALTEST', 'PAL_ARIMA_RESULT_T', 'OUT');
CALL SYS.AFLLANG_WRAPPER_PROCEDURE_DROP('PALTEST', 'PAL_ARIMAFORECAST_PROC');
CALL SYS.AFLLANG_WRAPPER_PROCEDURE_CREATE('AFLPAL','ARIMAFORECAST', 'PALTEST', 'PAL_ARIMAFORECAST_PROC', PAL_ARIMA_PDATA_TBL);
DROP TABLE PAL_CONTROL_TBL;
CREATE COLUMN TABLE PAL_CONTROL_TBL ( "NAME" VARCHAR (50),"INTARGS" INTEGER,"DOUBLEARGS" DOUBLE,"STRINGARGS" VARCHAR (100));
INSERT INTO PAL_CONTROL_TBL VALUES ('ForecastLength', FORECAST_LENGTH_GOES_HERE,null,null);
DROP TABLE PAL_ARIMA_RESULT_TBL;
CREATE COLUMN TABLE PAL_ARIMA_RESULT_TBL LIKE PAL_ARIMA_RESULT_T;
CALL PALTEST.PAL_ARIMAFORECAST_PROC(PAL_ARIMA_MODEL_TBL, "PAL_CONTROL_TBL", PAL_ARIMA_RESULT_TBL) WITH OVERVIEW;
SELECT * FROM PAL_ARIMA_RESULT_TBL;